# 一. 简介

一个复杂表达式中通常都有两个及以上操作符存在，在多个操作符之间，我们应该先执行哪个操作符和其操作数的运算主要由下面几点确定：

1. 优先级：运算符具有优先级，对于同一个表达式中的不同优先级的操作符，我们应该先执行优先级较高的操作符和其操作数的运算。
2. 结合律：对于同一个表达式中的相同优先级的操作符，我们应该先执行哪个操作符的运算由运算符的结合律确定，通常同一优先级的操作符其结合律也相同。举例来说，对于具有右结合律的操作符来说，多个相同优先级的操作符应该先执行最右边的一个操作符和其操作数的运算。
3. 求值顺序：对于单个操作符和其操作数来说，如果该操作符的操作数在两个及以上，求值顺序则会影响表达式的值。求值顺序决定了单个操作符的多个操作数中哪个操作数应该先进行求值。大部分的操作符都未定义其求值顺序，但有 4 种操作符进行了定义。
4. 运算对象转换（见 “类型转换-隐式转换” 部分）



# 二. 优先级、结合律、求值顺序

以一个例子来具体解释以下三者如何影响表达式的值：

```c++
f() + g() * h() + j();
```

首先根据**优先级**判断：表达式应该先执行`*`操作符和`g()`和`h()`的运算，然后执行两个`+`操作符的运算；

在执行完乘法之后，就应该判断两个`+`操作应该先做哪一个，根据`+`操作符的**结合律**应该先执行左侧的`+`操作符和其两个操作数的运算；

另外，在执行每一次运算时，都应该考虑**求值顺序**的问题，`*`操作符和`+`操作符都没有规定其求值顺序，具体反映如下：

- 第一步：`*`操作，由于未规定左右操作数应该先对谁进行求值，所以是未定义的，编译器可能先对`g()`求值，也可能先对`h()`求值。
- 第二步：左侧的`+`操作，由于未规定求值顺序，所以是未定义的，编译器可能先对`f()`求值，也可能先对`g() * h()`求值
- 第三步：右侧的`+`操作，和上述相同，编译器可能先对`j()`求值，也可能先对前面部分求值

这些操作都未定义求值顺序，如果各个函数执行的先后顺序不会影响其结果，则求值顺序无影响；而如果某个函数执行以后会影响另一个函数的求值结果，那么此时该表达式将是一条错误的表达式，将产生未定义的行为。

所有的运算符中只有 4 种明确规定了运算对象的求值顺序：

- 逻辑与`&&`运算符：它规定先求左侧运算对象的值，只有当左侧运算对象的值为真时才继续求右侧运算对象的值
- 逻辑或`||`运算符
- 条件`?:`运算符
- 逗号`,`运算符


