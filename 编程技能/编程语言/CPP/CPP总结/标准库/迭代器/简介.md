# 一. 简介

`string`和`vector`都属于容器类型，而所有的容器类型都可以使用迭代器。

迭代器就类似于指针类型，可以使用和指针相同的操作方法对对象进行间接访问。同时迭代器也能从一个元素移动到另外一个元素。

另外，迭代器有有效和无效之分：有效迭代器指向某个实际存在的元素或容器中最后一个元素的下一位置（尾后位置），其他所有情况都属于无效。

对于含有迭代器类型的类来说，我们不需要做任何其他的准备。而如果我们是想单独使用迭代器类型，就需要做下面的准备：

```c++
#include <iterator>
using std::iterator;
using std::const_iterator;
```

迭代器的类型可能为`std::iterator`或`std::const_iterator`，前者指向非常量元素，后者指向常量元素。



# 二. 操作

## 1. 直接获取迭代器

有迭代器的类型通常都有返回迭代器的成员，如`string`和`vector`都有拥有名为`begin`和`end`的成员函数，其中`begin`返回指向容器中第一个元素的位置，`end`返回指向容器最后一个元素的下一位置（**尾后迭代器**）。如果容器为空，`begin`和`end`返回同一个迭代器。

迭代器的类型为：`className::iterator`或`className::const_iterator`（若对象是常量，则返回后者）。也可以用`cbegin`和`cend`成员函数强制返回具有底层`const`的类型。

如：

```c++
std::vector<int> vi(10, 5);	// 10 个值为 5 的元素
std::vector<int>::iterator beg = vi.begin();
std::vector<int>::const_iterator end = vi.cend();
```

其中`beg`将指向`vi`中第 1 个元素，`end`将指向`vi`中第 11 个元素（一个不存在的元素，尾后位置，所以声明为`const_iterator`表示不能修改）。



## 2. 其他操作

| 操作                                   | 效果                                                         |
| -------------------------------------- | ------------------------------------------------------------ |
| `*iter`（`iter`表示一个迭代器）        | 返回迭代器`iter`所指元素的引用                               |
| `iter->mem`                            | 解引用`iter`并获取该元素的名为`mem`的成员，等价于`(*iter).mem` |
| `++iter`                               | 令`iter`指示容器中的下一个元素                               |
| `--iter`                               | 令`iter`指示容器中的上一个元素                               |
| `iter1 == iter2`<br />`iter1 != iter2` | 判断两个迭代器是否相等（不相等），如果两个迭代器指示的是同一个元素或者它们是同一个容器的尾后迭代器，则相等；反之，不相等 |



## 3. string 和 vector 提供的额外的操作

| 操作                                                         | 效果                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `iter + n`（`n`应该是一个`std::string::different_type`或`std::vector<T>::different_type`类型） | 迭代器加上一个整数值仍得到一个迭代器，迭代器指示的新位置与原来相比向前移动了若干个元素。结果迭代器指示容器内的一个元素，或者指向容器尾元素的下一位置 |
| `iter - n`                                                   | 与`iter + n`相反                                             |
| `iter1 += n`                                                 | 迭代器加法的复合赋值语句                                     |
| `iter1 -= n`                                                 | 迭代器减法的复合赋值语句                                     |
| `iter1 - iter2`                                              | 两个迭代器相减的结果是它们之间的距离，结果类型应该是：`std::string::different_type`或`std::vector<T>::different_type`类型，**有正负**。参与运算的两个迭代器必须指向同一个容器中的元素或者尾元素的下一位置 |
| `>`，`>=`，`<`，`<=`                                         | 迭代器的关系运算符，如果某迭代器指向的容器位置在另一个迭代器所指位置之前，则说前者小于后者。参与运算的两个迭代器必须指向的是同一个容器中的元素或者尾元素的下一位置。 |



# 三. 注意

## 1. 迭代器失效

有些对容器的操作会导致迭代器失效，以`vector`类型为例：

- 当使用范围`for`循环时，不能向`vector`对象中添加元素
- 当使用可能改变`vector`对象容量的操作时，会使已有的迭代器失效
