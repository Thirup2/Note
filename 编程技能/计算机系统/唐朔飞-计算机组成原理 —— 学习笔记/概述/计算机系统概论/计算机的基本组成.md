# 一. 典型的冯·诺伊曼计算机

1945 年，数学家冯·诺伊曼在研究 EDVAC 机时提出了 “存储程序” 的概念。以此概念为基础的各类计算机通称为冯·诺伊曼机。它的特点可归结如下：

- 计算机由运算器、存储器、控制器、输入设备和输出设备五大部件组成。
- 指令和数据以同等地位存放于存储期内，并可按地址寻访。
- 指令和数据均用二进制数表示。
- 指令由操作码和地址码组成，操作码用来表示操作的性质，地址码用来表示操作数在存储器中的位置。
- 指令在存储期内按顺序存放。通常，指令是顺序执行的，在特定条件下，可根据运算结果或根据设定的条件改变执行顺序。
- 机器以运算器为中心，输入输出设备与存储器间的数据传送通过运算器完成。

典型的冯·诺伊曼计算机如下图所示：

![未命名文件 (2)](https://user-images.githubusercontent.com/91216205/223039524-75d508f2-2f11-44b9-8adc-ecc1a21d7baf.jpg)

# 二. 现代的计算机

现代的计算机主要是在冯·诺依曼计算机的基础上将以运算器为中心转化为了以存储期为中心，如下图所示：

![未命名文件 (3)](https://user-images.githubusercontent.com/91216205/223042269-3e240623-eea8-47c9-abc6-d02c2dcb7f49.jpg)

图中各部件的功能如下：

- 运算器：用来完成算术和逻辑运算，并将运算的中间结果暂存在运算器内
- 存储器：用来存放数据和程序
- 控制器：用来控制、指挥程序和数据的输入、运行以及处理运算结果
- 输入设备：用来将人们熟悉的信息形式转换为机器能识别的信息形式，常见的有键盘、鼠标等
- 输出设备：用来将机器运算结果转换为人们熟悉的信息形式，如打印机输出、显示器输出等

计算机的五大部件（又称五大子系统）在控制器的统一指挥下，有条不紊地自动工作。

由于运算器和控制器在逻辑关系和电路结构上联系十分紧密，尤其在大规模集成电路制作工艺出现后，这两大部件往往集成在同一芯片上，因此通常将它们合起来统称为**中央处理器**。把输入设备与输出设备简称为 I/O 设备。

这样，现代计算机可认为由三大部分组成：CPU、I/O 设备及主存储器。另外，CPU 和主存储器合起来又可称为主机，I/O 设备又可称为外部设备，如下图所示：

![未命名文件 (4)](https://user-images.githubusercontent.com/91216205/223045155-8df15582-5bf5-4bc3-9bc9-fb86f1459cf7.jpg)

其中，主存储器是存储器子系统中的一类，用来存放程序和数据，可以直接和 CPU 交换信息。存储器还有一种类型，成为辅助存储器，简称辅存，又称外存。

算术逻辑单元（Arithmetic Logic Unit, ALU）简称算逻部件，用来完成算术逻辑运算。控制单元（Control Unit, CU）用来解释存储器中的指令，并发出各种操作命令来执行指令。ALU 和 CU 是 CPU 的核心部件。

I/O 设备也受 CU 控制，用来完成相应的输入、输出操作。



# 三. 计算机的工作步骤

用计算机解决一个实际问题通常包含两大步骤。一个是上机前的各种准备，另一个是上机运行。

## 1. 上机前的准备

在许多科学技术的实际问题中，往往会遇到许多复杂的数学方程组，而数字计算机通常只能执行加、减、乘、除四则运算，这就要求在上机解题前，先由人工完成一些必要的准备工作。这些工作大致可归纳为：建立数学模型、确定计算方法和编制解题程序 3 个步骤。

- 建立数学模型

  即找到一系列反应研究对象变化规律的数学方程组。

- 确定计算方法

  将数学模型中复杂的运算转换为适合计算机运算的加、减、乘、除四则运算，还必须确定对应的计算方法，如求 $\sin x$ 的值，必须将 $\sin x$ 进行转换：
  $$
  \sin x=x-{x^3\over 3!}+{x^5\over 5!}-{x^7\over 7!}+{x^9\over 9!}-\dots
  $$

- 编制解题程序

  即将运算步骤用一一对应的机器指令描述。这些机器指令包括 取数、存数、加、乘、打印、停机 等操作。



## 2. 计算机的工作过程

### 主存储器：

主存储器（简称主存或内存）包括 存储体M、各种逻辑部件及控制电路等，如下图所示：

![未命名文件](https://user-images.githubusercontent.com/91216205/223651610-416770a2-b2e1-44ed-a1e8-8b6d4beee2ea.jpg)

其中 存储体M 是主存储器中最主要的一部分，用来保存数据。存储体由许多存储单元组成，每个存储单元又包含若干个存储元件（或称存储基元、存储元），每个存储元件能寄存一位二进制代码。也就是说，一个存储单元可以存储一串二进制代码，称这串二进制代码为一个**存储字**，这串二进制代码的位数称为**存储字长**。存储字长可以是 8 位、16 位、32 位等，图中的存储字长就是 8 位。

另外，主存的工作方式是按照存储单元的地址号来实现对存储字各位的存、取。这种存取方式称为按地址存取方式，即按地址访问存储器（简称访存）。为了实现按地址访问的方式，主存中还必须配置两个寄存器：MAR 和 MDR。

其中 MAR（Memory Address Register）是存储器地址寄存器，用来存放与访问的存储单元的地址。通常，我们可以根据 MAR 的位数推测存储器的大小，如假设 MAR 有 10 位，则有 $2^{10}=1024$ 个存储单元，假设每个存储单元保存 8 位存储元件，即一字节，那么就无法访问存储体M中超过 1024 B 即 1 KB 后的数据。

MDR（Memory Data Register）是存储器数据寄存器，用来存放从存储体某单元取出的代码或者准备往某存储单元存储的代码，其位数与存储字长相等，即在上图中 MDR 为 8 位。

当然如果想要完整地完成一个取或存操作，CPU 还得给主存加以各种控制信号，如读命令、写命令和地址译码驱动信号等。随着硬件技术的发展，主存都制成大规模集成电路的芯片，而将 MAR 和 MDR 集成在 CPU 芯片中。

早期的计算机的存储字长一般和机器的指令字长与数据字长相等，故访问一次主存便可取一条指令或一个数据。随着计算机应用范围的不断扩大，解题精度的不断提高，往往要求指令字长是可变的，数据字长也要求可变。为了时应指令和数据字长的可变性，其长度不由存储字长来确定，而是由字节的个数来表示。即以 8 位为基准，虽然存储字长、指令字长、数据字长三者可各不相同，但是它们必须是 8 位的整数倍，即字节的整数倍。



### 运算器：

一个运算器最少包括 3 个寄存器和一个算术逻辑单元（ALU）。这 3 个必需的寄存器分别是：ACC（Accumulator，累加器）、MQ（Multiplier-Quotient Register，乘商寄存器）和 X（操作数寄存器）。

该结构的运算器执行 加、减、乘、除 四则运算的操作过程如下（`[M]`表示存储器中对应`M`地址号单元中的内容，`[寄存器]`表示寄存器中保存的内容）：

**加法**：
$$
[M]\to X\\
[ACC]+[X]\to ACC
$$
**减法**：
$$
[M]\to X\\
[ACC]-[M]\to ACC
$$
**乘法**：
$$
[M]\to MQ\\
[ACC]\to X\\
0\to ACC\\
[X]\times [MQ]\to ACC//MQ
$$

> 其中 `ACC//MQ` 表示两寄存器串接

**除法**：
$$
[M]\to X\\
[ACC]\div [X]\to MQ\\
余数[R]\to ACC
$$


### 控制器：

控制器是计算机的神经中枢，由它指挥各部件自动、协调地工作，它所作的操作主要有以下几个过程：取指过程、分析过程和执行过程。我们以一个程序的运行的例子解释控制器的工作过程。

首先我们写好了一个程序源文件，然后将这个文件编译成了可执行程序，保存在磁盘中，以 Windows 系统为例，此时可执行程序的后缀名应该是`.exe`，该文件内包含一段机器指令，它们是连续的。接下来我们双击该程序，这些机器指令就会被加载到主存储器中，PC（Program Counter, 程序计数器）将指向该代码段起始的位置，如下图所示：

![未命名文件 (1)](https://user-images.githubusercontent.com/91216205/223659659-eb53bf1a-0c56-44df-9742-4811f38988d0.jpg)

接下来取指过程开始：将 PC 指向的位置的内容交给 IR（Instruction Register, 指令寄存器），它用来存放当前的指令。

然后是分析过程：将 IR 中的操作码送至 CU，用来分析指令；将 IR 中的地址码作为操作数的地址送至存储器的 MAR。CU 分析当前指令所需完成的操作，并发出各种微操作命令序列

最后是执行过程：在进行执行过程之前，PC 首先自动加 1，即指向下一条指令，然后执行 CU 给出的命令序列。执行完成后，将从取指过程重新开始，如此循环，直到退出该程序段。

另外，在程序的执行过程中，当遇到创建变量或常量、调用函数、内存分配等操作时，操作系统通常还会在内存的某一段创建一个堆栈称为运行时堆栈，用来保存相应的内容，这个堆栈的地址通常保存在某个寄存器中，如下图所示：

![未命名文件 (3)](https://user-images.githubusercontent.com/91216205/223663641-dceef959-a7b2-4d4b-b802-e344252820d0.jpg)

### I/O：

I/O 子系统包括各种 I/O 设备及其相应的接口。每一种 I/O 设备都由 I/O 接口与主机联系，它接受 CU 发出的各种控制命令，并完成相应的操作。
