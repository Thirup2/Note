# 一. 前言

整数在C语言中分为两类，一类是无符号整数，一类是带符号整数，二者的编码方式有些不同。

在研究编码方式和操作时，会用到以下的数学术语：

| 符号     | 类型 | 含义             |
| -------- | ---- | ---------------- |
| $B2T_w$  | 函数 | 二进制转补码     |
| $B2U_w$  | 函数 | 二进制转无符号数 |
| $U2B_w$  | 函数 | 无符号数转二进制 |
| $U2T_w$  | 函数 | 无符号数转不嘛   |
| $T2B_w$  | 函数 | 补码转二进制     |
| $T2U_w$  | 函数 | 补码转无符号数   |
| $TMin_w$ | 常数 | 最小补码值       |
| $TMax_w$ | 常数 | 最大补码值       |
| $UMax_w$ | 常数 | 最大无符号数     |
| $+^t_w$  | 操作 | 补码加法         |
| $+_w^u$  | 操作 | 无符号数加法     |
| $*^t_w$  | 操作 | 补码乘法         |
| $*_w^u$  | 操作 | 无符号数乘法     |
| $-_w^t$  | 操作 | 补码取反         |
| $-_w^u$  | 操作 | 无符号数取反     |



# 二. 无符号数的编码

对于一个 $w$ 位的位向量，我们可以将其写成 $\vec {x}$，表示整个向量；也可以将其写成 $[x_{w-1},\ x_{w-2},\ \dots,\ x_0]$，表示向量中的每一位。

## 1. 定义

对向量 $\vec{x}=[x_{w-1},\ x_{w-2},\ \dots,\ x_0]$：
$$
B2U_w(\vec{x})=\sum^{w-1}_{i=0}x_i2^i
$$
该等式的含义是：将位向量 $\vec{x}$ 由二进制转换为无符号数后，其值为等号右边的部分

其中：

$x_i$ 即第 $i$（$i$ 从 0 开始）位的取值，非 0 即 1。

例：
$$
B2U_4([0001])=0\cdot 2^3+0\cdot 2^2+0\cdot 2^1+1\cdot 2^0=0+0+0+1=1\\
B2U_4([0101])=0\cdot 2^3+1\cdot 2^2+0\cdot 2^1+1\cdot 2^0=0+4+0+1=5\\
B2U_4([1011])=1\cdot 2^3+0\cdot 2^2+1\cdot 2^1+1\cdot 2^0=8+0+2+1=11\\
B2U_4([1111])=1\cdot 2^3+1\cdot 2^2+1\cdot 2^1+1\cdot 2^0=8+4+2+1=15
$$

## 2. 性质

- 最小值：0
- 最大值：$UMax_w=B2U_w([11\dots 1])=2^w-1$
- 唯一性：无符号数编码具有唯一性，即每个介于 $0\sim 2^w-1$ 之间的数都有唯一一个 $w$ 位的值编码



# 三. 有符号数的编码（补码编码）

## 1. 定义

对向量 $\vec{x}=[x_{w-1},\ x_{w-2},\ \dots,\ x_0]$：
$$
B2T_w(\vec{x})=-x_{w-1}2^{w-1}+\sum_{i=0}^{w-2}x_i2^i
$$
该等式的含义是：将向量 $\vec{x}$ 转换为补码后，其值等于右边的部分，

其中：

$x_{w-1}$ 表示用最高位表示符号，也称为**符号位**，当该位为 1 时，为负；

$-2^{w-1}$ 表示它的权重，是一个负数。

例：
$$
B2T_4([0001])=-0\cdot 2^3+0\cdot 2^2+0\cdot 2^1+1\cdot 2^0=0+0+0+1=1\\
B2T_4([0101])=-0\cdot 2^3+1\cdot 2^2+0\cdot 2^1+1\cdot 2^0=0+4+0+1=5\\
B2T_4([1011])=-1\cdot 2^3+0\cdot 2^2+1\cdot 2^1+1\cdot 2^0=-8+0+2+1=-5\\
B2T_4([1111])=-1\cdot 2^3+1\cdot 2^2+1\cdot 2^1+1\cdot 2^0=-8+4+2+1=-1
$$

## 2. 性质

- 最小值：$TMin_w=B2T_w([10\dots 0])=-2^{w-1}$；
- 最大值：$TMax_w=B2T_w([01\dots 1])=2^{w-1}-1$；
- 唯一性：补码编码具有唯一性，即每个介于 $-2^{w-1}\sim 2^{w-1}-1$ 之间的数都有唯一一个 $w$ 位的编码
- 补码的范围不对称：$|TMin|=|TMax|+1$
- 相同位向量转换成的无符号数值刚好比补码的最大值的两倍大一点：$UMax_w=2TMax_w+1$

**注意**：将全是 1 的位向量转换成补码并不像看上去负得那么多，其值刚好是负得最少的，为 $-1$ ；将除了符号位之外全是 0 的位向量转换成补码也并不上看上去负得那么少，其值是负得最多的，为 $-2^{w-1}$ 。

## 3. 其他编码方式

### 1）反码（Ones’  Complement）

其最高有效位的权是 $-(2^{w-1}-1)$ 而不是 $-2^{w-1}$，其余部分与补码相同：
$$
B2O_w(\vec{x})=-x_{w-1}(2^{w-1}-1)+\sum_{i=0}^{w-2}x_i2^i
$$
很明显，这种编码方式的正负值是对称的，最小值的绝对值与最大值相同，并且值为 0 的编码不唯一。

### 2）原码（Sign-Magnitude）

其最高有效位是符号位，并无权重，该位用来确定剩下的位应该取负还是取正：
$$
B2S_w(\vec{x})=(-1)x_{w-1}\cdot (\sum_{i=0}^{w-2}x_i2^i)
$$
这种编码将负数转换为正数的操作非常简单，只需要更改最高位的值即可。同时，它的正负值也是对称的，并且 0 的编码也不唯一。



# 四. 有符号数和无符号数之间的转换

