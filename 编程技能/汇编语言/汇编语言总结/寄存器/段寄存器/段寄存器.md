# 一. 简介

段寄存器包括：

- CS
- DS
- SS
- ES

这 4 个寄存器。当 8086 CPU 要访问内存时，由这 4 个段寄存器提供内存单元的段地址。



# 二. CS和IP

## 1. 简介

CS 和 IP 是 8086 CPU 中两个最关键的寄存器，他们指示了 CPU 当前要读取指令的地址。CS 为代码段寄存器，IP 为指令指针寄存器。

在 8086 PC 机中，任意时刻，假设 CS 中的内容为 M，IP 中的内容为 N，8086 CPU 将从内存 $M\times 16+N$ 单元开始，读取一条指令并执行。即任意时刻，CPU 将 CS:IP 指向的内容当作指令执行。

以下以一个指令的执行为例：

**前提条件**：

- 指令在内存中紧密依序排列，中间没有空位
- CS 指向代码段开始的位置，IP 指向第一个指令的起始位置偏移量

**执行过程**：

- 首先将 CS、IP 中的内容送入地址加法器，地址加法器完成计算
- 地址加法器将物理地址送入输入输出控制电路
- 输入输出控制电路将物理地址送上地址总线
- 从物理地址所在的位置将机器指令通过数据总线送入 CPU
- 输入输出控制电路将机器指令送入指令缓冲器
- 此时首先增加 IP 的值，如果此时指令缓冲器中是一个 3 字节的指令，则 IP 增加 3，如果此时指令缓冲器中是一个 2 字节的指令，则 IP 增加 2，以此类推。
- 然后将指令缓冲器中的指令送入执行控制器中执行
- 接下来循环完成以上步骤以执行其他指令

另外，在 8086PC 机加电启动或复位后，CS 和 IP 被设置为 CS=FFFFH，IP=0000H。



## 2. 相关指令

修改 CS、IP 的值不能使用`mov`指令，而应该使用`jmp`指令：

| 指令名称 | 用法            | 效果                                    | 注意                      |
| -------- | --------------- | --------------------------------------- | ------------------------- |
| jmp      | `jmp num1:num2` | 将 CS 修改为 `num1`，将 IP 修改为`num2` |                           |
| jmp      | `jmp reg`       | 仅将 IP 修改为`reg`的值                 | `reg`必须是一个合法寄存器 |



## 3. 代码段

对于 8086 PC 机，在编程时，可以根据需要，将一组内存单元定义为一个段。我们可以将长度为 $N(N\leqslant 64KB)$ 的一组代码，存在一组地址连续、起始地址为 16 的倍数的内存单元中，我们可以认为，这段内存是用来存放代码的，是一个代码段，段地址即起始地址，长度为 $N$。

为了使这段代码得到执行，我们需要设置 CS、IP 的值，将其指向该代码段的第一个指令。