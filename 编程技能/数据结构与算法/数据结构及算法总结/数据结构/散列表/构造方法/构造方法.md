# 一. 原则

对于一个好的散列函数，那么应该有下面两个原则：

1. **计算简单**：如果设计一个算法可以保证所有的关键字都不会产生冲突，但是这个算法需要很复杂的计算，会耗费很多时间，这对于频繁地查找来说，就会大大降低查找的效率了。因此散列函数的计算时间不应该超过其他查找技术与关键字比较的时间。
2. **散列地址分布均匀**：尽可能让散列地址均匀分布也可以降低冲突的概率，并且可以保证存储空间的有效利用。



# 二. 散列函数构造方法

## 1. 直接定址法

即直接用关键字来作为地址，先来看两个例子吧：

1. 如果关键字是年龄，假定所有人的年龄都低于150岁的话，那么就用一个容量为150的数组，0岁人数的保存在下标为0的位置，10岁的人数保存在下标为10的人数，以此类推。即$f(key)=key$
2. 如果关键字是出生年份，假定所有统计的人的出生年份都在1980年之后的话，那么1980年的人数就保存在下标为$1980-1980=0$的位置，1982的人数就保存在下标为2的位置，以此类推。即$f(key)=key-1980$

总结以上两个例子，我们可以取关键字的某个线性函数值为散列地址，即：
$
f(key)=a\times key+b
$
**优点**：简单、均匀，且不会产生冲突

**缺点**：需要事先直到关键字的分布情况

**适用**：查找表较小且连续的情况



## 2. 数字分析法

当关键字是位数较多的数字，如手机号码时，一般前7位数字是重复概率较高的，所以我们可以选择后4位来得到一个哈希值。

可以直接将后四位作为地址，也可以将这四位数字进行一些处理，如反转数字、右环位移、左环位移甚至前两数与后两数叠加等方法，无论什么方法，只要能够合理地将关键字分配到散列表的各位置。

这种方法的核心在于前面首先对关键字进行了处理，抽取了一部分数字，实际上不仅可以抽取连续的数字，也可以抽取不连续的数字。

**适用**：处理关键字位数比较多的情况，如果实现直到关键字的分布且关键字的若干位分布较均匀，就可以考虑用这个方法



## 3. 平方取中法

这个方法很简单，就是对关键字先取平方，然后抽取中间的几位数字即可。

**适用**：不知道关键字的分布，而位数又不是很多的情况。



## 4. 折叠法

折叠法是将关键字先分成几部分，然后将这几部分的数字求和所得的数字再进行抽取，最终所得的数字就作为地址。

**适用**：折叠法事先不需要知道关键字的分布，适合关键字位数较多的情况。



## 5. 除留余数法

该方法为最常用的构造散列函数的方法，对于散列表长为$m$的散列函数公式为：
$
f(key)=key\ \% \ p \ (p\leqslant m)
$
事实上，这方法不仅可以对关键字直接取模，也可在折叠、平方取中后再取模。

本方法的关键在于选择合适的$p$，$p$如果选得不好，就可能产生同义词。

根据经验：若散列表表长为$m$，通常$p$为小于或等于表长（最好接近$m$）的最小质数或不包含小于20质因子的合数



## 6. 随机数法

通过一个随机函数来得到关键字的随机值，然后将该随机值作为散列值即可。即$f(key)=random(key)$。这里$random$是随机函数。当关键字的长度不等时，采用这个方法构造散列函数是比较合适的



# 三. 决策

如何选择哪种散列函数可以通过以下因素来判断：

1. 计算散列地址所需的时间
2. 关键字的长度
3. 散列表的大小
4. 关键字的分布情况
5. 记录查找的频率
