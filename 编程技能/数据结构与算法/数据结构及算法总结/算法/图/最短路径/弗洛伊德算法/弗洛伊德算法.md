# 一. 定义

首先假设有两个矩阵，表示每个点之间的边。其中一个叫做$$D^{-1}$$，用来存储每条边的权值，其实就是邻接矩阵；另一个叫做$$P^{-1}$$，用来存储从对应顶点的最短路径的前驱矩阵，以行标为起点，以列标为终点，先将所有从起点到终点的最短路径设置为终点的值，也就是说到每个顶点的最短路径都先设置为不经过中转直接到该终点。

然后再遍历整个图，更新$$D^{-1}$$为$$D$$，表示以行标为起点，以列标为终点的所有最短路径值；更新$$P^{-1}$$到$$P$$，表示以行标为起点，以列标为终点的最短路径。



# 二. 案例

现有一个网图如下，求V0到V8的最短路径。

![Untitled](E:\Github\Myself\Backup\Notes\Web前端开发\Web前端开发总结\HTML5\创建HTML文档\使用脚本元素\195975285-de303545-831a-42e3-9def-3682339adffa.png)



# 三. 解决方法

1. 首先建立$$D^{-1}$$和$$P^{-1}$$两个矩阵：
   $$
   D^{-1}=\left[
   \begin{matrix}
   0&1&5&\infty &\infty &\infty &\infty &\infty &\infty \\
   1&0&3&7&5&\infty &\infty &\infty &\infty \\
   5&3&0&\infty &1&7&\infty &\infty &\infty \\
   \infty &7&\infty &0&2&\infty &3&\infty &\infty \\
   \infty &5&1&2&0&3&6&9&\infty \\
   \infty &\infty &7&\infty &3&0&\infty &5&\infty \\
   \infty &\infty &\infty &3&6&0&2&7&\infty \\
   \infty &\infty &\infty &\infty &9&5&2&0&4 \\
   \infty &\infty &\infty &\infty &\infty &\infty &7&4&0 \\
   \end{matrix}
   \right]
   $$

   $$
   P^{-1}=\left[
   \begin{matrix}
   0&1&2&3&4&5&6&7&8\\
   0&1&2&3&4&5&6&7&8\\
   0&1&2&3&4&5&6&7&8\\
   0&1&2&3&4&5&6&7&8\\
   0&1&2&3&4&5&6&7&8\\
   0&1&2&3&4&5&6&7&8\\
   0&1&2&3&4&5&6&7&8\\
   0&1&2&3&4&5&6&7&8\\
   \end{matrix}
   \right]
   $$

2. 然后从头开始每个点遍历，首先以V0为中转点，计算是否有最短路径的变化，其结果为否

3. 然后以V1为中转点，计算是否有最短路径的变化

   - 从`V[0][0]`开始一直到`V[8][8]`为止，以V1为中转点对矩阵进行遍历
   - V0-V0、V0-V1不用说，都是没有变化的，而V0-V1-V2比V0-V2更短，所以更新$$D^{-1}[V0][V2]$$为最新路径4，更新$$P^{-1}[V0][V2]$$为当前中转点V1的下标1
   - 以相同方法遍历整个矩阵，将所有路径减小的边进行修改

4. 然后以V2为中转点，计算相比于以更新后的两个矩阵是否又有变化，如果有就同上进行修改

5. 重复上述操作，直到以V8为中转点将矩阵遍历完，得到以下两个新矩阵：
   $$
   D=\left[
   \begin{matrix}
   0&1&4&7&5&8&10&12&16\\
   1&0&3&6&4&7&9&11&15\\
   4&3&0&3&1&4&6&8&12\\
   7&6&3&0&2&5&3&5&9\\
   5&4&1&2&0&3&5&7&11\\
   8&7&4&5&3&0&7&5&9\\
   10&9&6&3&5&7&0&2&6\\
   12&11&8&5&7&5&2&0&4\\
   16&15&12&9&11&9&6&4&0\\
   \end{matrix}
   \right]
   $$

   $$
   P=\left[
   \begin{matrix}
   0&1&1&1&1&1&1&1&1\\
   0&1&2&2&2&2&2&2&2\\
   1&1&2&4&4&4&4&4&4\\
   4&4&4&3&4&4&6&6&6\\
   2&2&2&3&4&5&3&3&3\\
   4&4&4&4&4&5&7&7&7\\
   3&3&3&3&3&7&6&7&7\\
   6&6&6&6&6&5&6&7&8\\
   7&7&7&7&7&7&7&7&8\\
   \end{matrix}
   \right]
   $$

   6. 其中根据矩阵`D`可以直接找出从某点到某点的最短距离
   7. 根据矩阵`P`可以找出从某点到某点的最短路径
      - 我们要查找从V0-V8的路径，所以我们先看$$P[V0][V8]$$，其值为1，所以第一个需要经过的中转点为V1，此时路径为V0-V1；
      - 然后我们让这个查找到的值取代列号，即查看$$P[V1][V8]$$，其值为2，所以此时路径为V0-V1-V2；
      - 然后查看$$P[V2][V8]$$，得到4，此时路径为V0-V1-V2-V4；
      - 然后查看$$P[V4][V8]$$，得到3，此时路径为V0-V1-V2-V4-V3；
      - 然后查看$$P[V3][V8]$$，得到6，此时路径为V0-V1-V2-V4-V3-V6；
      - 然后查看$$P[V6][V8]$$，得到7，此时路径为V0-V1-V2-V4-V3-V6-V7；
      - 然后查看$$P[V7][V8]$$，得到8，此时路径为V0-V1-V2-V4-V3-V6-V7-V8；
      - 此时已得到该最短路径，可以看到该路径与用迪杰斯特拉算法得到的相同。
