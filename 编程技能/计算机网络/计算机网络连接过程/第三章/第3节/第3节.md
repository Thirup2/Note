### 一. 构成
* `[-内存-MAC-PHY(MAU)-RJ45-]`模块多个
* 交换电路
* MAC地址表



### 二. 交换电路原理
* 电路概况: 一个表格状的电路, 通过开关控制线路走向
* 实现原理: 通过多个入口与多个出口且能控制线路走向的特性, 同时传输多路信号



### 三. MAC地址表
|MAC地址|端口|控制信息|
|:---:|:---:|:---:|
|00-60-97-A5-43-3C|2|...|
|00-00-C0-16-AE-FD|7|...|
|00-02-B3-1C-9C-F9|8|...|
|...|...|...|
* MAC地址表的维护
    * 收到包时, 将发送方MAC地址以及其输入端口的号码写入MAC地址表
    * 当某条记录一段时间内都没有使用, 将会在几分钟后被删除



### 四. 工作原理
1. 信号通过某端口的RJ-45接口到达PHY(MAU)模块
2. PHY(MAU)模块将电信号或光信号转换成通用信号交给MAC模块
3. MAC模块将通用信号转换成数字信息, 并通过包末尾的FCS校验错误
4. 如果没有问题则存放到缓冲区中
5. 通过包接收方的MAC地址和MAC地址表中记录的端口号决定发送的端口号
6. 通过交换电路将数据传到对应的端口线路上
7. 将数据放入内存, MAC读取并将其转换成通用信号传给PHY(MAU), PHY(MAU)将通用信号转换成电信号或光信号交给RJ-45接口, 通过网线传输
- **注: 整个过程中不会更改MAC头部中的MAC地址**



### 五. 特殊操作
1. 目标端口与源端口相同: 直接丢弃包
2. 地址表中找不到指定的MAC地址: 将包转发到除了源端口之外的所有端口
3. 如果接收方MAC地址是一个广播地址: 将包发送到除源端口之外的所有端口
* **注: 第二种特殊操作只会执行一次, 因为目标地址返回信息后会在该交换器中留下MAC地址和传入端口**



### 六. 半双工与全双工模式
* 半双工模式: 一般是使用集线器时使用
    * 需要碰撞处理机制
    * 不能同时收发信号
    
* 全双工模式: 不使用集线器时使用
    * 不需要碰撞处理机制
    * 可以同时收发信号
    
* 半双工与全双工模式的选择: 自动协商
    * 连接脉冲 
    
        在以太网中, 当没有数据在传输时, 网络中会填充一种被称为连接脉冲的脉冲信号, 使得网络中一直都有一定的信号流过, 从而能够检测对方是否在正常工作, 或者说网线有没有正常连接. 后来, 人们又设计出了具有特定排列的脉冲信号, 通过这种信号可以将自身的状态告知对方.
    
    * 状态
        * 自己能够支持的工作模式
        * 传输速率
        
    * 自动协商: 从双方传输的状态参数中选择一个最优的组合