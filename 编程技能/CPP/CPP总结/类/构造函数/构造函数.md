# 一. 简介

构造函数是一类特殊的成员函数，它负责一项工作，那就是创建一个类对象并初始化它。

其声明方式、定义方式以及调用方式都与一般的函数有所区别。

## 1. 默认构造函数

如果我们没有显式地提供一个构造函数，那么类会通过一个特殊的构造函数来控制默认初始化过程，这个函数叫做**默认构造函数**。其无须任何实参。

这个默认构造函数一般是由编译器为我们隐式地定义的（前提是没有显式地定义构造函数），其又被称为**合成的默认构造函数**。当我们定义了一些其他的构造函数时，我们必须自行定义一个默认的构造函数，否则类将没有默认构造函数。

>  对于大多数类来说，这个合成的默认构造函数将按照如下规则初始化类的数据成员：
>
> - 如果存在类内的初始值，则用它来初始化成员
> - 否则，默认初始化该成员

> 对于一些特殊的类，我们不能使用合成的默认构造函数：
>
> - 当类包含一些没有给定类内初始值的内置类型或复合类型的数据成员时，因为会被执行默认初始化，其值为未定义
> - 当类中包含一个其他类类型的成员且这个成员的类型没有默认构造函数时，编译器将无法初始化该成员

可以显式地声明一个默认构造函数，其格式如下：

```c++
ClassName() = default;
```

该函数的效果与合成的默认构造函数完全相同。

也可以定义一个不同于合成的默认构造函数的默认构造函数，其方法是提供一个初始值列表：

```c++
ClassName() : Init-List {};
```



## 2. 构造函数初始值列表

构造函数的函数体一般并不是用来初始化数据成员的，而是通过一个特殊的列表，叫做构造函数初始值列表来初始化类的数据成员。

它负责为新创建的对象的一个或几个数据成员赋初值。它是成员名字的一个列表，每个名字后面紧跟括号括起来（或者花括号括起来）的成员初始值，成员之间用逗号隔开。其格式如下：

```c++
ClassName() : Item1(Value1), Item2(Value2) {}
```

没包含在初始值列表中的数据成员按照与合成默认构造函数相同的方式隐式初始化。



# 二. 语法

## 1. 声明

一个构造函数的声明需要满足以下条件，当然大部分条件定义也必须满足：

1. 构造函数的名字与类名相同
2. 构造函数没有返回类型
3. 构造函数不能被声明成`const`的，因为初始化完成之后，一个对象才能获得其“常量”属性

其格式如下：

```c++
ClassName(<Para-List>);
```

一般某个类都会有多种初始化的方式，这可以通过重载构造函数来实现。



## 2. 定义

### 1）类内定义

类内定义就是将类内函数声明加上函数体构成定义，其初始值列表也属于定义。

对于默认与非默认构造函数，其定义方式可能有以下几类：

- 合成的默认构造函数显式定义

  ```c++
  ClassName() = default;
  ```

  其效果与合成的默认构造函数相同，之所以这样定义而不直接使用合成的默认构造函数是因为如果使用合成的默认构造函数意味着我们不能定义任何其他构造函数，所以显式地定义一个合成的默认构造函数，一般都意味着我们既需要一个合成的默认构造函数，也需要一些其他的构造函数。

  另外，当`default`出现在类内部时，那么默认构造函数是内联的。

- 非合成的默认构造函数

  ```c++
  ClassName() : Init-List {}
  ```

  通过初始值列表为类的数据成员设置初始值，其效果一般与提供类内初始值的合成默认构造函数效果相同。同样，它一般也意味着我们既需要默认构造函数，也需要其他的构造函数。

- 一般的构造函数

  ```c++
  ClassName(Para-List) : <Init-List> {}
  ```

  对于这类函数而言，一般传入的参数都是用作初始值列表的初始值。其初始值列表并非必要，因为有时会通过函数体来为成员赋值。



### 2）类外定义

和成员函数相同，构造函数的类外定义只需要在函数名之前添加一个作用域运算符即可，其余格式与类内定义相同。

如：

```c++
class ClassName
{
    /* ... */
    ClassName();
    ClassName(Para-List);
    /* ... */
};
ClassName::ClassName() = default; /* 或 */ ClassName() : <Init-List> {/* 构造函数体 */}
ClassName::ClassName(Para-List) : <Init-List> {/* 构造函数体 */}
```

当`=default`出现在类外时，默认构造函数是非内联的。