# 一. 返回数组类型

和参数一样，由于数组不允许拷贝，所以函数不能返回数组，但是可以返回数组的指针或引用。

## 1. 返回元素指针

可以返回指向数组头元素的指针：

```c++
int arr[10];
int *rei(int *arr, int arrSize);
```

使用这种方法必须要确保一点：**调用该函数的函数必须有办法能够知道被返回数组的大小**。



## 2. 返回数组指针

要返回一个数组指针，我们首先要清楚数组指针的定义方法：

```c++
int arr[10];
int (*pa)[10] = &arr;
```

需要注意不是：`int *pa[10] = &arr;`，这个声明的意图是创建一个指针的数组，并且会产生初始化错误。

所以一个数组指针的类型应该是：`type (*name)[size]`。

知道这一点后就好办了，这个声明中的`type`就是数组元素的类型，`size`是数组的大小，而`name`则是指向数组指针的名字，如果是函数，应该把函数名和形参列表都当作函数的名字，需要注意的是操作符的优先级，我们需要明确：**返回数组指针的函数应该首先是一个函数，其次才是一个指针**。

所以函数名应该首先和函数调用符结合，表示它是一个函数，然后再和`*`结合表示它是一个指针，当然，由于这两个运算符的优先级本来就是如此，所以可以不用加括号，具体形式如下：

```c++
int (*funPa(int i))[10];
```

`funPa`首先和后面的函数调用符结合，表示是一个接受一个`int`类型参数的函数；

然后和`*`结合，表明这个函数返回一个指针；

接下来与下标访问运算符结合，表明返回的指针是指向大小为 10 个元素的数组；

最后看到最前面的`int`，表示返回的指针所指的数组是一个`int`类型的数组。



## 3. 返回数组引用

数组引用的形式和数组指针类似：

```c++
int arr[10];
int (&funRe(int i))[10];
```

其中`funRe`就是一个接受一个`int`类型参数，返回一个大小为 10 个元素的数组的引用的函数。

如果想返回一个常量数组，则在`int`前添加一个`const`即可。



# 二. 简化

## 1. 使用尾置返回类型

在 C++ 中有一种办法可以将返回类型独立出来然后声明或定义函数，就是**尾置返回类型**（trailing return type）。

任何函数的定义都能使用尾置返回，但是这种形式对于返回类型比较复杂的函数最有效，具体的语法如下：

```c++
auto func(int i) -> int(*)[10];
```

1. 首先将函数的返回类型写成`auto`
2. 然后在函数的形参列表之后添加一个`->`运算符
3. 最后在`->`运算符后面写上真正需要返回的类型



## 2. 定义类型别名

可以定义类型别名来简化复杂返回类型的函数声明与定义，这种方法和尾置返回类型类似：

```c++
typedef int arrT[10];
using arrT = int[10];	// 和上一个别名相同

arrT *func(int i);		// arrT 是一个包含 10 个元素的数组，所以 func 返回一个指向包含 10 个元素数组的指针
```



## 3. 使用decltype

这种用法比较特殊：如果当我们直到函数返回的指针将指向哪个数组，就可以使用`decltype`关键字声明返回类型。

例如：

```c++
int odd[] = {1, 3, 5, 7, 9};
int even[] = {0, 2, 4, 6, 8};

decltype(odd) *arrPtr(int i)
{
    return (i % 2) ? &odd : &even;
}
```

需要注意的是：`decltype`严格返回被判断表达式的类型，所以`decltype(odd)`将返回一个包含 5 个`int`元素的数组类型，然后`arrPtr`返回指向这种类型的指针。

