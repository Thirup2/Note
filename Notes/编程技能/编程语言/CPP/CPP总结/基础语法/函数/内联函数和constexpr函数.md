# 一. 简介

使用函数有很多好处：

- 阅读和理解函数的调用比读懂等价的函数中的内容要容易的多
- 使用函数可以确保行为的统一，每次相关操作都能保证按照同样的方式进行
- 如果我们需要修改计算过程，只需要修改一处
- 函数可以被其他应用重复利用，省去了程序员重新编写的代价

但是使用函数有一个潜在的缺点：调用函数一般比求等价表达式的值要慢一些。

为了使某一组操作既存在函数的优点，又避免函数的缺点，可以使用**内联函数**（inline）



# 二. 内联函数

**使用**：

在函数声明或定义中，在函数的返回类型前加上关键字`inline`即可把函数指定为内联函数。

需要注意的是：

1. 内联函数只是向编译器发出的一个请求，编译器可以选择忽略这个请求
2. `inline`函数对编译器而言必须是可见的，以便它能够在调用点内展开该函数。所以`inline`函数必须在调用该函数的每个文本文件中定义，而且在同一个程序使用同一个内联函数时它们的定义必须相同。

所以为了更方便地使用内联函数，建议**将内联函数定义在头文件中**。

****

**内联函数的编程风格**：

关键字`inline`必须与函数体放在一起才能使函数成为内联，仅将`inline`放在函数声明前面不起任何作用。

总结如下：

- 内联函数声明时可以不添加`inline`关键字
- 内联函数定义时必须添加`inline`关键字



# 三. constexpr函数

**使用**：

`constexpr`函数是指**能用于常量表达式**的函数，定义`constexpr`函数的方法与其他函数类似，但需要遵守以下规定：

- 函数的返回类型及所有形参的类型都得是字面值类型（能被`constexpr`修饰的类型）
- 函数体中必须有且仅有一条`return`语句
- `constexpr`函数体内也可以包含其他语句，只要这些语句在运行时不执行任何操作即可。如，`constexpr`函数中可以有空语句、类型别名以及`using`声明

总结而言，`constexpr`函数如果编译器判断能够内联并且提供的参数能够让其返回一个常量表达式，那么此时这个`constexpr`函数调用就能用于常量表达式中，否则不行。

****

**注意**：

- `constexpr`函数的返回值可以不是一个常量，当函数的返回值是一个常量时`constexpr`函数才能被当作常量表达式使用。
- `constexpr`函数被隐式地指定为内联函数，所以遵循内联函数需要遵循的规则：
  - 需要在每个用到该函数的地方进行定义，且同一个程序中不同文件对该函数的定义必须相同（所以建议定义在头文件中）
  - 在声明处可以不用`constexpr`关键字，但是在定义处必须添加`constexpr`关键字

