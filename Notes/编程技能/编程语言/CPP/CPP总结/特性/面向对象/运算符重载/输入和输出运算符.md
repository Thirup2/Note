# 一. 输出运算符`<<`

## 1. 函数签名

**形参**：

通常情况下，输出运算符的第一个形参是一个非常量`ostream`对象的引用，之所以`ostream`是非常量是因为向流写入内容会改变其状态；而该形参是引用是因为我们无法直接复制一个`ostream`对象。

第二个形参一般来说是一个常量的引用，该常量是我们想要打印的类类型。第二个形参是引用的原因是我们希望避免复制实参；而之所以该形参可以是常量是因为（通常情况下）打印对象不会改变对象的内容。

**返回**：

为了与其他输出运算符保持一致，`operator<<`一般要返回它的`ostream`形参。

**是否成员**：

与`iostream`标准库兼容的输入输出运算符必须是普通的非成员函数，而不能是类的成员函数。否则，它们的左侧运算对象将是我们的类的一个对象：

```c++
Sales_data data;
data << cout;
```

这违反直觉和我们一直使用的习惯。

假设输入输出运算符是某个类的成员，则它们也必须是`istream`或`ostream`的成员。然而，这两个类属于标准库，并且我们无法给标准库中的类添加任何成员。

因此，如果我们希望为类自定义 IO 运算符，则必须将其定义成非成员函数。当然，IO 运算符通常需要读写类的非公有数据成员，所以 IO 运算符一般被声明为有元。



## 2. 注意

用于内置类型的输出运算符不太考虑格式化操作，尤其不会打印换行符，用户希望类的输出运算符也像如此行事。如果运算符打印了换行符，则用户就无法在对象的同一行内接着打印一些描述性的文本了。相反，令输出运算符尽量减少格式化操作可以使用户有权控制输出的细节。



# 二. 输入运算符`>>`

## 1. 函数签名

**形参**：

通常情况下，输入运算符的第一个形参是运算符将要读取的流的引用，第二个形参时将要读入到的（非常量）对象的引用。

第二个形参之所以必须是个非常量是因为输入运算符本身的目的就是将数据读入到这个对象中

**返回**：

该运算符通常会返回某个给定流的引用

**是否成员**：

与输出运算符`<<`相同，为非成员函数



## 2. 注意

输入时可能产生下列错误：

- 当流含有错误类型的数据时读取操作可能失败。当某个成员的读取操作失败后，后续的读取操作及其他对流的使用都将失败
- 当读取操作到达文件末尾或者遇到输入流的其他错误时也会失败

在程序中一般不逐个检查每个读取操作，而是等读取了所有数据后赶在使用这些数据前一次性检查：

```c++
if (is)
    item.revenue = item.units_sold * price;
else
    item = Sales_data();
```

如果发生了错误，我们无须在意到底是哪部分输入失败，只要将一个新的默认初始化的`Sales_data`对象赋予`item`从而将其重置为空`Sales_data`就可以了。

