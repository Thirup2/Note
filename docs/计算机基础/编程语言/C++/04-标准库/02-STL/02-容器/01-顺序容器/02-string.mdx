## 一、构造 string 的其他方法

- `n`、`len2`和`pos2`都是无符号值

| 操作                       | 效果                                                         |
| -------------------------- | ------------------------------------------------------------ |
| `string s(cp)`             | `s`是`cp`指向的 C 风格字符串中不包含末尾空字符的拷贝。非`explicit`，故可拷贝 |
| `string s(cp, n)`          | `s`是`cp`指向的数组中前`n`个字符的拷贝。<br />此数组至少应该包含`n`个字符 |
| `string s(s2, pos2)`       | `s`是`string s2`从下标`pos2`开始的字符的拷贝。<br />若`pos2>s2.size()`，构造函数的行为未定义 |
| `string s(s2, pos2, len2)` | `s`是`string s2`从下标`pos2`开始`len2`个字符的拷贝。<br />若`pos2>s2.size()`，构造函数的行为未定义。<br />不管`len2`的值是多少，构造函数至多拷贝`s2.size()-pos2`个字符 |



## 二、获取子字符串

| 操作               | 效果                                                         |
| ------------------ | ------------------------------------------------------------ |
| `s.substr(pos, n)` | 返回一个`string`，包含`s`中从`pos`开始直到`s`结束的字符的拷贝。<br />`pos`的默认值为 0，`n`的默认值为`s.size()-pos`，故有三种调用方式。<br />注：如果开始位置超过了`string`的大小，则`substr`函数抛出一个`out_of_range`异常 |



## 三、修改 string

| 操作                     | 效果                                                         |
| ------------------------ | ------------------------------------------------------------ |
| `s.insert(pos, args)`    | 在`pos`之前插入`args`指定的字符。<br />`pos`可以是一个下标或一个迭代器。<br />接受下标的版本返回一个指向`s`的引用；接受迭代器的版本返回指向第一个插入字符的迭代器 |
| `s.erase(pos, len)`      | 删除从位置`pos`开始的第`len`个字符。如果`len`被省略，则删除从`pos`开始直至`s`末尾的所有字符。<br />返回一个指向`s`的引用 |
| `s.assign(args)`         | 将`s`中的字符替换为`args`指定的字符。<br />返回一个指向`s`的引用 |
| `s.append(args)`         | 将`args`追加到`s`。<br />返回一个指向`s`的引用。             |
| `s.replace(range, args)` | 删除`s`中范围`range`内的字符，替换为`args`指定的字符。<br />`range`可以是一个下标+一个长度，或者是一对指向`s`的迭代器。<br />返回一个指向`s`的引用 |

- 对于`append`和`assign`，`args`可以是下列任何形式

  - `str`：字符串`str`，不能和`s`相同
  - `str`，`pos`，`len`：`str`中从`pos`开始最多`len`个字
  - `cp`，`len`：从`cp`指向的字符数组的前（最多）`len`个字符
  - `cp`：`cp`指向的以空字符结尾的字符数组
  - `n`，`c`：`n`个字符`c`
  - `b`，`e`：迭代器`b`和`e`指定的范围内的字符
  - 初始化列表：花括号包围的，以逗号分隔的字符列表

- 对于`insert`和`replace`，`args`的情况如下表所示：

  | `args`可以是    | `replace(pos, len, args)` | `replace(b, e, args)` | `insert(pos, args)` | `insert(iter, args)` |
  | --------------- | ------------------------- | --------------------- | ------------------- | -------------------- |
  | `str`           | 是                        | 是                    | 是                  | 否                   |
  | `str, pos, len` | 是                        | 否                    | 是                  | 否                   |
  | `cp, len`       | 是                        | 是                    | 是                  | 否                   |
  | `cp`            | 是                        | 是                    | 否                  | 否                   |
  | `n, c`          | 是                        | 是                    | 是                  | 是                   |
  | `b2, e2`        | 否                        | 是                    | 否                  | 是                   |
  | 初始化列表      | 否                        | 是                    | 否                  | 是                   |



## 四、string 搜索

`string`搜索操作统一返回指定字符出现的下标，如果未找到则返回`npos`

| 操作                        | 效果                                              |
| --------------------------- | ------------------------------------------------- |
| `s.find(args)`              | 查找`s`中`args`第一次出现的位置                   |
| `s.rfind(args)`             | 查找`s`中`args`最后一次出现的位置                 |
| `s.find_first_of(args)`     | 在`s`中查找`args`中任何一个字符第一次出现的位置   |
| `s.find_last_of(args)`      | 在`s`中查找`args`中任何一个字符最后一次出现的位置 |
| `s.find_first_not_of(args)` | 在`s`中查找第一个不在`args`中的字符               |
| `s.find_last_not_of(args)`  | 在`s`中查找最后一个不在`args`中的字符             |

- `args`必须是以下形式之一
  - `c, pos`：从`s`中位置`pos`开始查找字符`c`。`pos`默认为 0
  - `s2, pos`：从`s`中位置`pos`开始查找字符串`s2`。`pos`默认为 0
  - `cp, pos`：从`s`中位置`pos`开始查找指针`cp`指向的 C 风格字符串。`pos`默认为 0
  - `cp, pos, n`：从`s`中位置`pos`开始查找指针`cp`指向的数组的前`n`个字符。`pos`和`n`无默认值



## 五、string 比较

| 操作              | 效果                                                         |
| ----------------- | ------------------------------------------------------------ |
| `s.compare(args)` | 将`s`与`args`指定的字符串进行比较.<br />根据`s`是等于、大于还是小于参数指定的字符串，返回 0、整数或负数 |

- `args`的几种参数形式：
  - `s2`：比较`s`和`s2`
  - `pos1, n1, s2`：将`s`中`pos1`开始的`n1`个字符与`s2`进行比较
  - `pos1, n1, s2, pos2, n2`：将`s`中`pos1`开始的`n1`个字符与`s2`中从`pos2`开始的`n2`个字符进行比较
  - `cp`：比较`s`与`cp`指向的 C 风格字符串
  - `pos1, n1, cp`：将`s`中从`pos1`开始的`n1`个字符与`cp`指向的 C 风格字符串进行比较
  - `pos1, n1, cp, n2`：将`s`中从`pos1`开始的`n1`个字符与指针`cp`指向的地址开始的`n2`个字符进行比较



## 六、数值转换

| 操作                                                         | 效果                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `to_string(val)`                                             | 一组重载函数，返回数值`val`的`string`表示。<br />`val`可以是任何算数类型。对每个浮点类型和`int`或更大的整型，都有相应版本的`to_string`.<br />与往常一样，小整型会被提升 |
| `stoi(s, p, b)`<br />`stol(s, p, b)`<br />`stoul(s, p, b)`<br />`stoll(s, p, b)`<br />`stoull(s, p, b)` | 返回`s`的起始子串（表示整数内容）的数值<br />返回值类型分别是`int`、`long`、`unsigned long`、`long long`、`unsigned long long`<br />`b`表示转换所用的基数（进制），默认值是 10。<br />`p`是`size_t`指针，用来保存`s`中第一个非数值字符的下标，`p`默认为 0，即函数不保存下标 |
| `stof(s, p)`<br />`stod(s, p)`<br />`stold(s, p)`            | 返回`s`的起始子串（表示浮点数内容）的数值，<br />返回值类型分别是`float`、`double`或`long double`<br />参数`p`的作用与整数转换函数中一样。 |



## 七、输入输出

| 操作               | 效果                                                         |
| ------------------ | ------------------------------------------------------------ |
| `os << str`        | 将`str`写入到输出流`os`中                                    |
| `is >> str`        | 从输入流`is`中将内容写入`str`中，从第一个非空白符开始到空白符结束，不包括最后遇到的空白符 |
| `getline(is, str)` | 从输入流`is`读取一行内容到`str`中，不包含换行符              |



## 八、字符串连接

| 操作          | 效果                           |
| ------------- | ------------------------------ |
| `str1 + str2` | 返回`str1`和`str2`连接后的结果 |

:::info string 对象与字符串字面值混合相加

在一个需要`string`对象的地方如果使用字符串字面值，该字面值可以自动转换为`string`对象。故当`string`对象与字符串字面值混合相加时，需要考虑`+`操作符的结合律。由于`+`从左往右进行计算，所以不能将两个字符串字面值放在整个加法的最前面，因为没有语法允许两个字符串字面值的加法操作，例如：

```cpp
string s1 = "hello", s2 = "world";
string s3 = s1 + ", " + s2 + "!\n";			// 正确
string s4 = s1 + ", " + "world" + "!\n";	// 正确
// error-next-line
string s5 = "hello" + ", " + s2 + "!\n";	// 错误
```

:::



## 九、与旧代码的接口

如果程序某处需要一个 C 风格字符串，但我们只有`string`对象时，不能像使用 C 风格字符串代替`string`对象（例如`string`初始化，`string`加法等）一样使用`string`对象替代 C 风格字符串。

但`string`类提供了一个操作可以获取一个`string`对象对应的 C 风格字符串：

| 操作          | 效果                                                         |
| ------------- | ------------------------------------------------------------ |
| `str.c_str()` | 返回`const char*`类型的值，该指针指向的 C 风格字符串和`str`这个`string`对象保存了相同的字符串 |

需要注意的是，由于返回的是一个`const char*`类型的指针，所以不能通过这个指针修改原本的字符串内容。

同时，虽然该函数的实现并不清楚，但当我们通过原本的`string`对象修改了字符串的内容后，所返回的这个 C 风格字符串通常将会失效。
