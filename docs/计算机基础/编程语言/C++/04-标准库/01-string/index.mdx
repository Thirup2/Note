---
title: string
---

## 使用前

```cpp
#include <string>
using std::string;
using std::getline;
```



## 一、简介

`string`是一个字符串类型，具体实现是可变长字符序列，用于保存`char`类型字符的字符串以及执行字符串的一系列操作，并且`string`类型字符串不包含结尾的空字符，对其进行遍历时不能以空字符作为判断条件。

`string`来自于`std::basic_string`模板，由于字符串类型设计目的是用来保存字符串，而字符的类型又是有限的，故所有字符类型的实例化字符串类型都直接在标准库中定义过了，可直接使用，具体包括：

```cpp
using std::wstring;
using std::u16string;
using std::u32string;
```

这些类型用来保存不同尺寸字符的字符串，由于它们来自同一个模板，所以在它们之上的操作完全相同。



## 二、接口

### 1. 类型

| 类型                                           | 用处                                                       |
| ---------------------------------------------- | ---------------------------------------------------------- |
| `std::string::size_type`                       | 用于标记字符串长度的类型。`str.size()`返回该类型的值       |
| `std::string::iterator`                        | 字符串迭代器类型。`str.begin()`、`str.end()`返回该类型的值 |
| `std::string::const_iterator`                  | 只读迭代器。`str.cbegin()`、`str.cend()`返回该类型的值     |
| `std::string::const_iterator::difference_type` | 迭代器之差类型。两迭代器相减返回该值                       |



### 2. 定义与初始化

| 初始化方式            | 效果                                            |
| --------------------- | ----------------------------------------------- |
| `string s1`           | 默认初始化为空串                                |
| `string s2(s1)`       | 拷贝`s1`至`s2`                                  |
| `string s2 = s1`      | 效果同上                                        |
| `string s3("value")`  | 将字面值`"value"`转换为`string`类型并拷贝至`s3` |
| `string s3 = "value"` | 效果同上                                        |
| `string s4(n, 'c')`   | 用`n`个`'c'`字符构成的字符串初始化`s4`          |



### 3. 其他操作

- `os`：输出流对象
- `is`：输入流对象
- `str`：`string`对象

| 操作                                                         | 效果                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| `os << str`                                                  | 将`str`写入到输出流`os`中                                    |
| `is >> str`                                                  | 从输入流`is`中将内容写入`str`中，从第一个非空白符开始到空白符结束，不包括最后遇到的空白符 |
| `getline(is, str)`                                           | 从输入流`is`读取一行内容到`str`中，不包含换行符              |
| `str.empty()`                                                | `str`为空返回`true`，否则返回`false`                         |
| `str.size()`                                                 | 返回`str`中字符的个数                                        |
| `str[n]`                                                     | 返回`str`中第`n`个字符的引用，位置`n`从 0 计起               |
| `str1 + str2`                                                | 返回`str1`和`str2`连接后的结果                               |
| `str1 = str2`                                                | 将`str1`赋值为`str2`                                         |
| `str1 == str2`<br />`str1 != str2`                           | 相等性判断，如果两字符串完全相同，返回`true`；否则返回`false`<br />注：`string`对象的相等性判断对字母的大小写敏感 |
| `str1 < str2`<br />`str1 <= str2`<br />`str1 > str2`<br />`str1 >= str2` | 按字典序进行比较，且对字母的大小写敏感。<br />如果较短字符串和较长字符串前部分完全相同，则较长字符串大 |

:::info string 对象与字符串字面值混合相加

在一个需要`string`对象的地方如果使用字符串字面值，该字面值可以自动转换为`string`对象。故当`string`对象与字符串字面值混合相加时，需要考虑`+`操作符的结合律。由于`+`从左往右进行计算，所以不能将两个字符串字面值放在整个加法的最前面，因为没有语法允许两个字符串字面值的加法操作，例如：

```cpp
string s1 = "hello", s2 = "world";
string s3 = s1 + ", " + s2 + "!\n";			// 正确
string s4 = s1 + ", " + "world" + "!\n";	// 正确
// error-next-line
string s5 = "hello" + ", " + s2 + "!\n";	// 错误
```

:::



### 4. 迭代支持

- 范围`for`语句
- 下标迭代
- 迭代器迭代



### 5. 与旧代码的接口

如果程序某处需要一个 C 风格字符串，但我们只有`string`对象时，不能像使用 C 风格字符串代替`string`对象（例如`string`初始化，`string`加法等）一样使用`string`对象替代 C 风格字符串。

但`string`类提供了一个操作可以获取一个`string`对象对应的 C 风格字符串：

| 操作          | 效果                                                         |
| ------------- | ------------------------------------------------------------ |
| `str.c_str()` | 返回`const char*`类型的值，该指针指向的 C 风格字符串和`str`这个`string`对象保存了相同的字符串 |

需要注意的是，由于返回的是一个`const char*`类型的指针，所以不能通过这个指针修改原本的字符串内容。

同时，虽然该函数的实现并不清楚，但当我们通过原本的`string`对象修改了字符串的内容后，所返回的这个 C 风格字符串通常将会失效。



## 三、字符类别检查

很多时候我们需要检查字符串中每一个字符的类别，例如大写字母、小写字母、数字、符号等。

我们可以使用`<cctype>`头文件提供的函数：

| 函数          | 返回类型 | 判断类型或效果                           |
| ------------- | -------- | ---------------------------------------- |
| `isalnum(c)`  | `bool`   | 字母、数字                               |
| `isalpha(c)`  | `bool`   | 字母                                     |
| `iscntrl(c)`  | `bool`   | 控制字符                                 |
| `isdigit(c)`  | `bool`   | 数字                                     |
| `isgraph(c)`  | `bool`   | 非空格可打印字符                         |
| `islower(c)`  | `bool`   | 小写字母                                 |
| `isprint(c)`  | `bool`   | 包括空格的可打印字符                     |
| `ispunct(c)`  | `bool`   | 标点符号                                 |
| `isspace(c)`  | `bool`   | 空白字符                                 |
| `isupper(c)`  | `bool`   | 大写字母                                 |
| `isxdigit(c)` | `bool`   | 十六进制数                               |
| `tolower(c)`  | `char`   | 输出大写字母的小写形式，其余字符原样输出 |
| `toupper(c)`  | `char`   | 输出小写字母的大写形式，其余字符原样输出 |

