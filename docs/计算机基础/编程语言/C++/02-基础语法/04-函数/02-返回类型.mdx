## 一、无返回值函数

没有返回值的函数的返回类型为`void`，这样的函数可以不需要`return`语句，在函数执行结束之后会隐式地执行`return`。

如果需要在函数中间位置提前退出，可以使用不带返回值的`return`语句，或返回一个`void`类型的值，通常是另一个返回`void`的函数调用。

例如：

```cpp
void fun1()
{
    // ...
    return;		// 中途退出函数
    // ...
}

void fun2()
{
    // ...
    return fun1();		// 返回 void 类型值
}
```



## 二、有返回值函数

只要函数的返回类型不是`void`，则该函数内的每条`return`语句必须返回一个值，`return`语句返回值的类型必须和函数的返回类型相同或者能够隐式地转换成函数的返回类型。

### 1. 值的返回方式

返回一个值的方式和初始化一个变量或形参的方式完全一样：返回的值用于初始化调用点的一个临时量，该临时量就是函数调用的结果。

:::caution 返回引用和指针

需要注意的是，返回值也可以返回引用或指针，但千万不要返回一个函数局部变量的引用或指针，因为和它们所绑定的那个局部变量将在函数调用结束后被销毁，也就是说这样的引用和指针将指向不再有效的内存区域。

如果要返回一个引用或指针，那通常是返回的一个动态分配内存的对象的引用或指针，这样的对象不会在函数终止后被销毁。

:::



### 2. 返回类类型

一个返回类类型的函数调用语句可以当做一个类对象进行使用，例如：

```cpp
const string &shorterString(const string &s1, const string &s2);

auto sz = shorterString(s1, s2).size();
```



### 3. 引用返回左值

调用一个返回引用的函数得到左值（实际上对一个返回指针的函数调用进行解引用也将得到一个左值，但返回值本身不是左值）。

我们可以像使用其他左值那样来使用返回引用的函数的调用，特别是我们可以为返回类型是**非常量引用**的函数的结果赋值。

```cpp
char &get_val(string &str, string::size_type ix);

int main()
{
    string s("a value");
    cout << s << endl;
    // highlight-next-line
    get_val(s, 0) = 'A';
    cout << s << endl;
    return 0;
}
```



### 4. 列表返回值

返回值可以是一个列表，返回值是列表的函数的返回类型必须能够接受这个列表返回值作为初始值。

例如，大部分内置类型也支持列表初始化，但作为这些类型的列表初始值只能有一个初始值，且该值所占的空间不应该大于目标类型的空间。

如果函数返回的是类类型，那么由类本身定义初始值如何使用。

```cpp
vector<string> process()
{
    // ...
    // 设 expected、actual 是 string 对象
    if (expected.empty())
        return {};		// 返回空 vector
    else if (expected == actual)
        return {"functionX", "okay"};
    else
        return {"functionX", expected, actual};
}
```



### 5. main 函数返回值

返回类型只要不是`void`，就必须有`return`语句，但在`main`函数中是个例外。

如果控制到达了`main`函数的结尾处且没有`return`语句，那么编译器将隐式地插入一条返回 0 的`return`语句。

对于`main`函数来说，返回 0 表示执行成功，而返回其他值则表示执行失败。



### 6. 返回数组

数组不支持直接进行拷贝，但我们仍然可以用和传入数组参数类似的方法返回一个数组：

- 返回指向数组首元素的指针：这种方法在返回值中并不常用，除非被返回的数组在主调函数中能够有办法知道其范围。C 风格字符串是最常用的可行的方法。通过这种方法返回的数组（实际上是指针）仍然不能使用迭代器功能（包括范围`for`语句）。
- 返回指向数组本身的指针和引用：这种方法是比较好的返回数组的方法，这样返回的数组其范围确定，而且还可以使用迭代器功能。唯一的缺点是只能返回固定长度的数组。



## 三、尾置返回类型

对于返回值类型比较复杂的函数来说，将复杂的返回类型和函数的其他符号纠缠在一起将很难分辨该函数的返回类型究竟是什么。

其一种解决方法就是使用类型别名。

其二还可以使用尾置返回类型的格式，其方法是用`auto`替换掉原来的返回类型，然后将真正的返回类型通过`->`符号尾缀在函数签名之后：

```cpp
int (*func(int i))[10];			// 原来的格式
auto func(int i) -> int(*)[10];	// 尾缀的格式
```

当然，如果我们有一个和函数返回的类型相同的对象，也可以使用`decltype`进行简化：

```cpp
int (*arr)[10];
decltype(arr) func(int i);
```