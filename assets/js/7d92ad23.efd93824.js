"use strict";(self.webpackChunknote=self.webpackChunknote||[]).push([[5317],{3905:(e,t,n)=>{n.d(t,{Zo:()=>o,kt:()=>N});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=a.createContext({}),k=function(e){var t=a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):p(p({},t),e)),n},o=function(e){var t=k(e.components);return a.createElement(d.Provider,{value:t},e.children)},m="mdxType",s={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,d=e.parentName,o=i(e,["components","mdxType","originalType","parentName"]),m=k(n),u=r,N=m["".concat(d,".").concat(u)]||m[u]||s[u]||l;return n?a.createElement(N,p(p({ref:t},o),{},{components:n})):a.createElement(N,p({ref:t},o))}));function N(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,p=new Array(l);p[0]=u;var i={};for(var d in t)hasOwnProperty.call(t,d)&&(i[d]=t[d]);i.originalType=e,i[m]="string"==typeof e?e:r,p[1]=i;for(var k=2;k<l;k++)p[k]=n[k];return a.createElement.apply(null,p)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},847:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>p,default:()=>s,frontMatter:()=>l,metadata:()=>i,toc:()=>k});var a=n(7462),r=(n(7294),n(3905));const l={},p=void 0,i={unversionedId:"\u8ba1\u7b97\u673a\u57fa\u7840/\u7f16\u7a0b\u8bed\u8a00/C++/\u6807\u51c6\u5e93/\u5b9e\u7528\u5de5\u5177/\u52a8\u6001\u5185\u5b58/\u667a\u80fd\u6307\u9488/shared_ptr\u7c7b",id:"\u8ba1\u7b97\u673a\u57fa\u7840/\u7f16\u7a0b\u8bed\u8a00/C++/\u6807\u51c6\u5e93/\u5b9e\u7528\u5de5\u5177/\u52a8\u6001\u5185\u5b58/\u667a\u80fd\u6307\u9488/shared_ptr\u7c7b",title:"shared_ptr\u7c7b",description:"\u4e00\u3001\u57fa\u672c\u64cd\u4f5c",source:"@site/docs/\u8ba1\u7b97\u673a\u57fa\u7840/\u7f16\u7a0b\u8bed\u8a00/C++/04-\u6807\u51c6\u5e93/02-\u5b9e\u7528\u5de5\u5177/02-\u52a8\u6001\u5185\u5b58/02-\u667a\u80fd\u6307\u9488/01-shared_ptr\u7c7b.mdx",sourceDirName:"\u8ba1\u7b97\u673a\u57fa\u7840/\u7f16\u7a0b\u8bed\u8a00/C++/04-\u6807\u51c6\u5e93/02-\u5b9e\u7528\u5de5\u5177/02-\u52a8\u6001\u5185\u5b58/02-\u667a\u80fd\u6307\u9488",slug:"/\u8ba1\u7b97\u673a\u57fa\u7840/\u7f16\u7a0b\u8bed\u8a00/C++/\u6807\u51c6\u5e93/\u5b9e\u7528\u5de5\u5177/\u52a8\u6001\u5185\u5b58/\u667a\u80fd\u6307\u9488/shared_ptr\u7c7b",permalink:"/\u8ba1\u7b97\u673a\u57fa\u7840/\u7f16\u7a0b\u8bed\u8a00/C++/\u6807\u51c6\u5e93/\u5b9e\u7528\u5de5\u5177/\u52a8\u6001\u5185\u5b58/\u667a\u80fd\u6307\u9488/shared_ptr\u7c7b",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{},sidebar:"CPP_Language",previous:{title:"\u76f4\u63a5\u7ba1\u7406\u5185\u5b58",permalink:"/\u8ba1\u7b97\u673a\u57fa\u7840/\u7f16\u7a0b\u8bed\u8a00/C++/\u6807\u51c6\u5e93/\u5b9e\u7528\u5de5\u5177/\u52a8\u6001\u5185\u5b58/\u76f4\u63a5\u7ba1\u7406\u5185\u5b58"},next:{title:"\u52a8\u6001\u6570\u7ec4",permalink:"/\u8ba1\u7b97\u673a\u57fa\u7840/\u7f16\u7a0b\u8bed\u8a00/C++/\u6807\u51c6\u5e93/\u5b9e\u7528\u5de5\u5177/\u52a8\u6001\u5185\u5b58/\u52a8\u6001\u6570\u7ec4"}},d={},k=[{value:"\u4e00\u3001\u57fa\u672c\u64cd\u4f5c",id:"\u4e00\u57fa\u672c\u64cd\u4f5c",level:2},{value:"\u4e8c\u3001shared_ptr \u6a21\u578b",id:"\u4e8cshared_ptr-\u6a21\u578b",level:2},{value:"1. \u6784\u9020 shared_ptr",id:"1-\u6784\u9020-shared_ptr",level:3},{value:"2. \u8d4b\u503c\u6216\u7ed9\u5b9a\u521d\u59cb\u503c\u7684\u6784\u9020",id:"2-\u8d4b\u503c\u6216\u7ed9\u5b9a\u521d\u59cb\u503c\u7684\u6784\u9020",level:3},{value:"3. \u62f7\u8d1d",id:"3-\u62f7\u8d1d",level:3},{value:"4. \u6790\u6784",id:"4-\u6790\u6784",level:3},{value:"5. make_shared \u7684\u4e0d\u540c",id:"5-make_shared-\u7684\u4e0d\u540c",level:3},{value:"\u4e09\u3001\u64cd\u4f5c\u89e3\u6790",id:"\u4e09\u64cd\u4f5c\u89e3\u6790",level:2},{value:"\u56db\u3001\u4f7f\u7528\u6ce8\u610f",id:"\u56db\u4f7f\u7528\u6ce8\u610f",level:2}],o={toc:k},m="wrapper";function s(e){let{components:t,...l}=e;return(0,r.kt)(m,(0,a.Z)({},o,l,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"\u4e00\u57fa\u672c\u64cd\u4f5c"},"\u4e00\u3001\u57fa\u672c\u64cd\u4f5c"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"shared_ptr"),"\u662f\u4e00\u4e2a\u7c7b\u6a21\u677f\uff0c\u5b9e\u4f8b\u5316\u65f6\u9700\u8981\u63d0\u4f9b\u6307\u9488\u6307\u5411\u7684\u7c7b\u578b\u4f5c\u4e3a\u5b9e\u4f8b\u5316\u53c2\u6570\u3002"),(0,r.kt)("p",null,"\u5176\u57fa\u672c\u64cd\u4f5c\u5982\u4e0b\u8868\u6240\u793a\uff1a"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u64cd\u4f5c"),(0,r.kt)("th",{parentName:"tr",align:null},"\u6548\u679c"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"shared_ptr<T> sp")),(0,r.kt)("td",{parentName:"tr",align:null},"\u9ed8\u8ba4\u521d\u59cb\u5316\u3002",(0,r.kt)("br",null),"\u7a7a\u667a\u80fd\u6307\u9488\uff0c\u53ef\u4ee5\u6307\u5411\u7c7b\u578b\u4e3a",(0,r.kt)("inlineCode",{parentName:"td"},"T"),"\u7684\u5bf9\u8c61")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"shared_ptr<T> p(q)")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"p"),"\u662f",(0,r.kt)("inlineCode",{parentName:"td"},"shared_ptr q"),"\u7684\u62f7\u8d1d\uff1b\u6b64\u64cd\u4f5c\u4f1a\u9012\u589e",(0,r.kt)("inlineCode",{parentName:"td"},"q"),"\u4e2d\u7684\u8ba1\u6570\u5668\u3002",(0,r.kt)("inlineCode",{parentName:"td"},"q"),"\u4e2d\u7684\u6307\u9488\u5fc5\u987b\u80fd\u8f6c\u6362\u6210",(0,r.kt)("inlineCode",{parentName:"td"},"T*"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"make_shared<T>(args)")),(0,r.kt)("td",{parentName:"tr",align:null},"\u8fd4\u56de\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"td"},"shared_ptr"),"\uff0c\u6307\u5411\u4e00\u4e2a\u52a8\u6001\u5206\u914d\u7684\u7c7b\u578b\u4e3a",(0,r.kt)("inlineCode",{parentName:"td"},"T"),"\u7684\u5bf9\u8c61\u3002\u4f7f\u7528",(0,r.kt)("inlineCode",{parentName:"td"},"args"),"\u521d\u59cb\u5316\u6b64\u5bf9\u8c61")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"*p")),(0,r.kt)("td",{parentName:"tr",align:null},"\u89e3\u5f15\u7528",(0,r.kt)("inlineCode",{parentName:"td"},"p"),"\uff0c\u83b7\u5f97\u5b83\u6307\u5411\u7684\u5bf9\u8c61")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"p->mem")),(0,r.kt)("td",{parentName:"tr",align:null},"\u7b49\u4ef7\u4e8e",(0,r.kt)("inlineCode",{parentName:"td"},"(*p).mem"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"p.get()")),(0,r.kt)("td",{parentName:"tr",align:null},"\u8fd4\u56de",(0,r.kt)("inlineCode",{parentName:"td"},"p"),"\u4e2d\u4fdd\u5b58\u7684\u6307\u9488\u3002",(0,r.kt)("br",null),"\u9700\u8981\u6ce8\u610f\uff1a\u82e5\u667a\u80fd\u6307\u9488\u91ca\u653e\u4e86\u5176\u5bf9\u8c61\uff0c\u8fd4\u56de\u7684\u6307\u9488\u6240\u6307\u5411\u7684\u5bf9\u8c61\u4e5f\u5c31\u6d88\u5931\u4e86")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"swap(p, q)"),(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"p.swap(q)")),(0,r.kt)("td",{parentName:"tr",align:null},"\u4ea4\u6362",(0,r.kt)("inlineCode",{parentName:"td"},"p"),"\u548c",(0,r.kt)("inlineCode",{parentName:"td"},"q"),"\u4e2d\u7684\u6307\u9488")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"p = q")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"p"),"\u548c",(0,r.kt)("inlineCode",{parentName:"td"},"q"),"\u90fd\u662f",(0,r.kt)("inlineCode",{parentName:"td"},"shared_ptr"),"\uff0c\u6240\u4fdd\u5b58\u7684\u6307\u9488\u5fc5\u987b\u80fd\u591f\u76f8\u4e92\u8f6c\u6362\u3002",(0,r.kt)("br",null),"\u6b64\u64cd\u4f5c\u4f1a\u9012\u51cf",(0,r.kt)("inlineCode",{parentName:"td"},"p"),"\u7684\u5f15\u7528\u8ba1\u6570\uff0c\u9012\u589e",(0,r.kt)("inlineCode",{parentName:"td"},"q"),"\u7684\u5f15\u7528\u8ba1\u6570\uff1b\u82e5",(0,r.kt)("inlineCode",{parentName:"td"},"p"),"\u7684\u5f15\u7528\u8ba1\u6570\u53d8\u4e3a 0\uff0c\u5219\u5c06\u5176\u7ba1\u7406\u7684\u539f\u5185\u5b58\u91ca\u653e")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"p.unique()")),(0,r.kt)("td",{parentName:"tr",align:null},"\u82e5",(0,r.kt)("inlineCode",{parentName:"td"},"p.use_count()"),"\u4e3a 1\uff0c\u8fd4\u56de",(0,r.kt)("inlineCode",{parentName:"td"},"true"),"\uff1b\u5426\u5219\u8fd4\u56de",(0,r.kt)("inlineCode",{parentName:"td"},"false"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"p.use_count()")),(0,r.kt)("td",{parentName:"tr",align:null},"\u8fd4\u56de\u4e0e",(0,r.kt)("inlineCode",{parentName:"td"},"p"),"\u5171\u4eab\u5bf9\u8c61\u7684\u667a\u80fd\u6307\u9488\u6570\u91cf\uff1b\u53ef\u80fd\u5f88\u6162\uff0c\u4e3b\u8981\u7528\u4e8e\u8c03\u8bd5")))),(0,r.kt)("h2",{id:"\u4e8cshared_ptr-\u6a21\u578b"},"\u4e8c\u3001shared_ptr \u6a21\u578b"),(0,r.kt)("p",null,"\u8981\u7406\u89e3",(0,r.kt)("inlineCode",{parentName:"p"},"shared_ptr"),"\u4e3a\u4f55\u662f\u201c\u667a\u80fd\u201d\u6307\u9488\uff0c\u9996\u5148\u6211\u4eec\u9700\u8981\u7406\u89e3\u5176\u5185\u90e8\u6784\u9020\u548c\u64cd\u4f5c\u539f\u7406\u3002"),(0,r.kt)("p",null,"\u672c\u5c0f\u8282\u5c06\u7b80\u8ff0\u5176\u5185\u90e8\u6784\u9020\u548c\u57fa\u672c\u7684\u6784\u9020\u51fd\u6570\u3001\u62f7\u8d1d\u64cd\u4f5c\u7684\u539f\u7406\u3002"),(0,r.kt)("h3",{id:"1-\u6784\u9020-shared_ptr"},"1. \u6784\u9020 shared_ptr"),(0,r.kt)("p",null,"\u5f53\u6211\u4eec\u4f7f\u7528\u9ed8\u8ba4\u521d\u59cb\u5316\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"shared_ptr"),"\u65f6\uff0c\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"shared_ptr"),"\u5bf9\u8c61\u7684\u7ed3\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"01",src:n(6737).Z,width:"1179",height:"555"})),(0,r.kt)("p",null,"\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"shared_str"),"\u5bf9\u8c61\u4ec5\u4ec5\u5305\u542b\u4e24\u4e2a\u6307\u9488\uff0c\u5206\u522b\u662f\u6307\u5411\u63a7\u5236\u5757\u7684\u6307\u9488\u548c\u6307\u5411\u8d44\u6e90\u7684\u6307\u9488\u3002\u53ea\u4e0d\u8fc7\u8fd9\u4e2a\u6307\u5411\u63a7\u5236\u5757\u7684\u6307\u9488\u4f1a\u7acb\u523b\u5206\u914d\u5185\u5b58\uff0c\u5176\u4e2d\u5f31\u5f15\u7528\u8ba1\u6570\u4f1a\u7acb\u5373+1\uff0c\u800c\u7531\u4e8e\u9ed8\u8ba4\u521d\u59cb\u5316\u6ca1\u6709\u8d44\u6e90\u5bf9\u8c61\uff0c\u63a7\u5236\u5757\u4e2d\u7684\u8d44\u6e90\u6307\u9488\u548c",(0,r.kt)("inlineCode",{parentName:"p"},"shared_str"),"\u7684\u8d44\u6e90\u6307\u9488\u90fd\u6307\u5411",(0,r.kt)("inlineCode",{parentName:"p"},"nullptr"),"\uff0c\u6240\u4ee5\u5f15\u7528\u8ba1\u6570\u4ecd\u7136\u662f 0\u3002"),(0,r.kt)("admonition",{title:"\u5f31\u5f15\u7528\u8ba1\u6570\u548c\u5f15\u7528\u8ba1\u6570",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"\u4ece\u4e0a\u56fe\u4e2d\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u4f7f\u7528\u52a8\u6001\u5185\u5b58\u5206\u914d\u7684\u5bf9\u8c61\u6709\u4e24\u90e8\u5206\uff0c\u4e00\u4e2a\u662f\u63a7\u5236\u5757\uff0c\u53e6\u4e00\u4e2a\u662f\u5b9e\u9645\u7684\u8d44\u6e90\u3002"),(0,r.kt)("p",{parentName:"admonition"},"\u8fd9\u4e24\u90e8\u5206\u90fd\u901a\u8fc7\u8ba1\u6570\u5668\u6765\u51b3\u5b9a\u5176\u751f\u5b58\u65f6\u95f4\uff0c\u5f53\u5f15\u7528\u8ba1\u6570\u4e3a 0 \u65f6\uff0c\u5c06\u81ea\u52a8\u91ca\u653e\u8d44\u6e90\u7684\u52a8\u6001\u5185\u5b58\uff0c\u800c\u5f53\u5f31\u5f15\u7528\u8ba1\u6570\u4e3a 0 \u65f6\uff0c\u5c06\u81ea\u52a8\u91ca\u653e\u63a7\u5236\u5757\u7684\u52a8\u6001\u5185\u5b58\u3002"),(0,r.kt)("p",{parentName:"admonition"},"\u6240\u4ee5\uff0c\u5b9e\u9645\u4e0a\u5f15\u7528\u8ba1\u6570\u7528\u6765\u7ba1\u7406\u5b9e\u9645\u7684\u8d44\u6e90\uff0c\u800c\u5f31\u5f15\u7528\u8ba1\u6570\u7528\u6765\u7ba1\u7406\u63a7\u5236\u5757\uff0c\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"weak_ptr"),"\u53ea\u4f1a\u589e\u52a0\u4e00\u4e2a\u63a7\u5236\u5757\u4e2d\u7684\u5f31\u5f15\u7528\u8ba1\u6570\uff0c\u800c\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"shared_ptr"),"\u4e0d\u4ec5\u4f1a\u589e\u52a0\u4e00\u4e2a\u5f31\u5f15\u7528\u8ba1\u6570\uff0c\u4e5f\u4f1a\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u589e\u52a0\u5f15\u7528\u8ba1\u6570\u3002")),(0,r.kt)("h3",{id:"2-\u8d4b\u503c\u6216\u7ed9\u5b9a\u521d\u59cb\u503c\u7684\u6784\u9020"},"2. \u8d4b\u503c\u6216\u7ed9\u5b9a\u521d\u59cb\u503c\u7684\u6784\u9020"),(0,r.kt)("p",null,"\u5bf9\u4e00\u4e2a\u7a7a\u7684\u667a\u80fd\u6307\u9488\u8d4b\u503c\uff0c\u6211\u4eec\u9996\u5148\u9700\u8981\u624b\u52a8\u5206\u914d\u4e00\u5757\u52a8\u6001\u5185\u5b58\uff0c\u7136\u540e\u4ea4\u7ed9\u667a\u80fd\u6307\u9488\u7ba1\u7406\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cpp"},"shared_ptr<int> sp(new int(4));\n")),(0,r.kt)("p",null,"\u8fd9\u6837\u7684\u64cd\u4f5c\u4f1a\u5bfc\u81f4\u539f\u672c\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"shared_ptr"),"\u5bf9\u8c61\u7ed3\u6784\u53d8\u5316\u5982\u4e0b\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"02",src:n(831).Z,width:"1179",height:"555"})),(0,r.kt)("p",null,"\u9996\u5148\u521b\u5efa\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"int"),"\u5bf9\u8c61\u7684\u5185\u5b58\u5e76\u521d\u59cb\u5316\u5b83\uff0c\u7136\u540e",(0,r.kt)("inlineCode",{parentName:"p"},"shared_ptr"),"\u6307\u5411\u7684\u63a7\u5236\u5757\u4e2d\u7684\u8d44\u6e90\u6307\u9488\u548c\u5176\u672c\u8eab\u7684\u8d44\u6e90\u6307\u9488\u90fd\u5c06\u6307\u5411\u8fd9\u5757\u5185\u5b58\uff0c\u7136\u540e\u5f15\u7528\u8ba1\u6570\u4f1a+1."),(0,r.kt)("h3",{id:"3-\u62f7\u8d1d"},"3. \u62f7\u8d1d"),(0,r.kt)("p",null,"\u5f53\u6211\u4eec\u5c06\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"shared_ptr"),"\u62f7\u8d1d\u7ed9\u53e6\u4e00\u4e2a\u5bf9\u8c61\u65f6\uff0c\u5e76\u4e0d\u4f1a\u521b\u5efa\u53e6\u4e00\u4e2a\u63a7\u5236\u5757\u548c\u53e6\u4e00\u4e2a\u8d44\u6e90\uff0c\u800c\u662f\u4f1a\u8ba9\u5b83\u4eec\u6307\u5411\u540c\u4e00\u5757\u63a7\u5236\u5757\u548c\u8d44\u6e90\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cpp"},"shared_ptr<int> sp(new int(4));\nshared_ptr<int> sp_copy(sp);\n")),(0,r.kt)("p",null,"\u4e0a\u8ff0\u4ee3\u7801\u4f7f\u6b64\u65f6\u7684\u667a\u80fd\u6307\u9488\u7ed3\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"03",src:n(1914).Z,width:"1266",height:"654"})),(0,r.kt)("p",null,"\u5177\u4f53\u5206\u4e3a\u4e09\u6b65\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u7b2c1\u6b65\uff1a\u7cfb\u7edf\u521b\u5efa\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"li"},"shared_ptr"),"\u5bf9\u8c61\uff0c\u6ce8\u610f",(0,r.kt)("inlineCode",{parentName:"li"},"shared_ptr"),"\u5bf9\u8c61\u672c\u8eab\u5e76\u4e0d\u9700\u8981\u52a8\u6001\u5206\u914d\u5185\u5b58\uff0c\u6240\u4ee5\u8fd9\u4e00\u6b65\u662f\u7cfb\u7edf\u505a\u7684"),(0,r.kt)("li",{parentName:"ul"},"\u7b2c2\u6b65\uff1a\u4f7f\u62f7\u8d1d\u5bf9\u8c61\u4e2d\u7684\u63a7\u5236\u5757\u6307\u9488\u548c\u8d44\u6e90\u6307\u9488\u90fd\u6307\u5411\u88ab\u62f7\u8d1d\u5bf9\u8c61\u4e2d\u4e24\u4e2a\u6307\u9488\u6240\u6307\u7684\u76f8\u540c\u7684\u4f4d\u7f6e"),(0,r.kt)("li",{parentName:"ul"},"\u7b2c3\u6b65\uff1a\u9012\u589e\u5f15\u7528\u8ba1\u6570\u548c\u5f31\u5f15\u7528\u8ba1\u6570")),(0,r.kt)("h3",{id:"4-\u6790\u6784"},"4. \u6790\u6784"),(0,r.kt)("p",null,"\u667a\u80fd\u6307\u9488\u53ef\u80fd\u662f\u4e00\u4e2a\u5c40\u90e8\u53d8\u91cf\uff0c\u5f53\u5b83\u79bb\u5f00\u5176\u4f5c\u7528\u57df\u65f6\uff0c\u4f1a\u81ea\u52a8\u9500\u6bc1\u8fd9\u4e2a\u667a\u80fd\u6307\u9488\uff0c\u5373\u8c03\u7528\u8be5\u7c7b\u578b\u7684\u6790\u6784\u51fd\u6570\u3002\u5bf9\u4e8e",(0,r.kt)("inlineCode",{parentName:"p"},"shared_ptr"),"\u7c7b\u578b\uff0c\u8fd9\u4e2a\u6790\u6784\u51fd\u6570\u6267\u884c\u5982\u4e0b\u64cd\u4f5c\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u9996\u5148\u9012\u51cf\u5f15\u7528\u8ba1\u6570\u548c\u5f31\u5f15\u7528\u8ba1\u6570"),(0,r.kt)("li",{parentName:"ol"},"\u5f53\u5f15\u7528\u8ba1\u6570\u9012\u51cf\u4e3a 0 \u65f6\uff0c\u8d44\u6e90\u5185\u5b58\u5c06\u88ab\u81ea\u52a8\u91ca\u653e\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u5f53\u5f31\u5f15\u7528\u8ba1\u6570\u9012\u51cf\u4e3a 0 \u65f6\uff0c\u63a7\u5236\u5757\u5185\u5b58\u5c06\u88ab\u81ea\u52a8\u91ca\u653e")),(0,r.kt)("p",null,"\u4e3a\u4e86\u5c06\u8fd9\u4e09\u4e2a\u64cd\u4f5c\u7684\u6548\u679c\u90fd\u4f53\u73b0\u51fa\u6765\uff0c\u6211\u4eec\u518d\u5f80\u5176\u4e2d\u6dfb\u52a0\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"weak_ptr"),"\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cpp"},"weak_ptr<int> sp_weak(sp);\n")),(0,r.kt)("p",null,"\u8fd9\u6837\uff0c\u73b0\u5728\u7684\u7ed3\u6784\u5c31\u5982\u4e0b\u56fe\u6240\u793a\u4e86\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"04",src:n(4581).Z,width:"1888",height:"654"})),(0,r.kt)("p",null,"\u63a5\u4e0b\u6765\u5c06\u4e09\u4e2a\u5bf9\u8c61\u9010\u6b65\u8fdb\u884c\u6790\u6784\uff1a"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5f53 sp_copy \u88ab\u9500\u6bc1\u65f6"),"\uff1a"),(0,r.kt)("p",null,"\u5f15\u7528\u8ba1\u6570\u3001\u5f31\u5f15\u7528\u8ba1\u6570\u9012\u51cf 1 \u4e14\u9012\u51cf\u540e\u90fd\u4e0d\u4e3a\u96f6\uff0c\u63a7\u5236\u5757\u548c\u8d44\u6e90\u65e0\u53d8\u5316\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"05",src:n(8137).Z,width:"1167",height:"654"})),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5f53 sp \u88ab\u9500\u6bc1\u65f6"),"\uff1a"),(0,r.kt)("p",null,"\u5f15\u7528\u8ba1\u6570\u3001\u5f31\u5f15\u7528\u8ba1\u6570\u9012\u51cf 1\uff0c\u9012\u51cf\u540e\u5f15\u7528\u8ba1\u6570\u4e3a 0 \u6545\u8d44\u6e90\u88ab\u91ca\u653e\uff0c\u4f46\u5f31\u5f15\u7528\u8ba1\u6570\u8fd8\u4e0d\u4e3a 0\uff0c\u63a7\u5236\u5757\u4ecd\u7136\u4fdd\u7559\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"06",src:n(4125).Z,width:"1137",height:"547"})),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5f53 sp_weak \u88ab\u9500\u6bc1\u65f6"),"\uff1a"),(0,r.kt)("p",null,"\u5f31\u5f15\u7528\u8ba1\u6570\u9012\u51cf 1\uff0c\u9012\u51cf\u540e\u5f31\u5f15\u7528\u8ba1\u6570\u4e3a 0\uff0c\u6545\u81ea\u52a8\u91ca\u653e\u63a7\u5236\u5757\uff0c\u968f\u540e\u91ca\u653e",(0,r.kt)("inlineCode",{parentName:"p"},"sp_weak"),"\u5bf9\u8c61"),(0,r.kt)("h3",{id:"5-make_shared-\u7684\u4e0d\u540c"},"5. make_shared \u7684\u4e0d\u540c"),(0,r.kt)("p",null,"\u4f7f\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"new"),"\u5206\u914d\u7684\u5185\u5b58\u505a\u521d\u59cb\u503c\u548c\u4f7f\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"make_shared"),"\u521b\u5efa\u7684\u5185\u5b58\u505a\u521d\u59cb\u503c\u662f\u6709\u6240\u4e0d\u540c\u7684\uff0c\u524d\u8005\u6211\u4eec\u5728\u4e4b\u524d\u5df2\u7ecf\u770b\u5230\u8fc7\u4e86\uff0c\u8fd9\u91cc\u6211\u4eec\u6765\u770b\u4e00\u4e0b",(0,r.kt)("inlineCode",{parentName:"p"},"make_shared"),"\u5177\u4f53\u6709\u4ec0\u4e48\u4e0d\u540c\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u793a\u4f8b\u4ee3\u7801"),"\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cpp"},"shared_ptr<int> sp = make_shared<int>(42);\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5185\u90e8\u7ed3\u6784"),"\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"07",src:n(9445).Z,width:"988",height:"582"})),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4e0d\u540c\u70b9"),"\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u539f\u672c\u7684\u63a7\u5236\u5757\u5bf9\u8c61\u548c\u8d44\u6e90\u5bf9\u8c61\u662f\u4e24\u5757\u5206\u79bb\u7684\u5185\u5b58\uff0c\u4f46",(0,r.kt)("inlineCode",{parentName:"li"},"make_shared"),"\u5206\u914d\u7684\u8fd9\u4e24\u90e8\u5206\u5bf9\u8c61\u5728\u540c\u4e00\u5757\u8fde\u7eed\u5185\u5b58\u4e2d"),(0,r.kt)("li",{parentName:"ul"},"\u63a7\u5236\u5757\u5bf9\u8c61\u4e2d\u4e0d\u5728\u5b58\u5728\u6307\u5411\u8d44\u6e90\u5bf9\u8c61\u7684\u6307\u9488"),(0,r.kt)("li",{parentName:"ul"},"\u7531\u4e8e\u4e0a\u9762\u7684\u4e0d\u540c\uff0c\u6240\u4ee5\u4ec5\u4ec5\u5f53\u5f15\u7528\u8ba1\u6570\u9012\u51cf\u5230 0 \u65f6\u5e76\u4e0d\u4f1a\u5bfc\u81f4\u8d44\u6e90\u5bf9\u8c61\u88ab\u91ca\u653e\uff0c\u53ea\u6709\u5f53\u5f31\u5f15\u7528\u8ba1\u6570\u4e5f\u9012\u51cf\u5230 0 \u65f6\uff0c\u63a7\u5236\u5757\u5185\u5b58\u88ab\u91ca\u653e\uff0c\u5176\u4e2d\u7684\u8d44\u6e90\u5bf9\u8c61\u624d\u968f\u4e4b\u91ca\u653e")),(0,r.kt)("h2",{id:"\u4e09\u64cd\u4f5c\u89e3\u6790"},"\u4e09\u3001\u64cd\u4f5c\u89e3\u6790"),(0,r.kt)("h2",{id:"\u56db\u4f7f\u7528\u6ce8\u610f"},"\u56db\u3001\u4f7f\u7528\u6ce8\u610f"))}s.isMDXComponent=!0},6737:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/01-b659df70810aeded2987b71b04a26709.jpg"},831:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/02-7d0ff035f738f44ef21704a672957725.jpg"},1914:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/03-04ed235ef12699a33768c69e9a35df35.jpg"},4581:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/04-d359b27ab118340e25e9361a94aa5de8.jpg"},8137:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/05-d6c52eecf0d6899a371be79e2e872cd6.jpg"},4125:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/06-1d430df4dbe1381928ba0b902fb9c298.jpg"},9445:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/07-da32a131b9a3418935ec9cb327327ec0.jpg"}}]);